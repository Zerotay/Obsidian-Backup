# 배포 파일 작성
![[Pasted image 20240318095623.png]]
도커 컴포즈로 현재 떠 있는 컨테이너를 확인하여 블루를 지정한다.

헬스체크는 총 두번을 거쳐서 한다. 컴포즈를 통해 도커 파일에 지정된 헬스체크를 발동시킨다. 이게 가장 근본적인 헬스체크.

마지막은 느징스 상에서 이뤄진다.

파이썬 서버를 gpu에 올려도 될 듯하다. 그러면 ec2의 부담이 줄어들 것이다. 모델이 돌아가는 서버는 확실히 따로 두는 게 메리트가 있다. 
대신에 시간이 많지 않으므로 파이썬 서버의 무중단 배포는 과감히 포기한다.

무중단 배포 성공!
![[Pasted image 20240318152934.png]]
이런 식으로 짜서, 무중단 배포가 되는 것을 확인했다.

# 젠킨스 설정
이제 모든 준비가 거의 끝났다. 젠킨스로 실제로 배포가 되도록 하면 된다.
아직 개발용만 만들고 배포용은 못 만들었지만, 실질적으로 다른 것은 없기 때문에 크게 어려운 것을 없을 것으로 생각된다. 
그러니 젠킨스로 cicd가 되게 만들기만 하면 일단 되는 것이다.

이번에는 정말 Jenkinsfile까지 활용하고 멀티브랜치 파이프라인을 만들어보자
https://velog.io/@jae_cheol/%EB%A9%80%ED%8B%B0%EB%B8%8C%EB%9E%9C%EC%B9%98-%ED%8C%8C%EC%9D%B4%ED%94%84%EB%9D%BC%EC%9D%B8