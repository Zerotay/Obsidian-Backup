---
tags:
  - vim
  - "#docker"
  - "#docker-compose"
  - "#diary"
  - "#obsidian"
---
# 도커 컴포즈 공부

- 이전 프로젝트 도커 활용법
	- 모든 애플리케이션을 개별 컨테이너로 관리
	- 새로 배포를 진행할 시
		- 컨테이너를 죽이지 않음
		- exec을 통해 내부에 명령을 가하는 방식
	- 문제점
		- 이미지를 통한 버전 관리가 되지 않음
			- 필수 사항은 아님
			- 현재의 백엔드에서 롤백을 해야 하는 상황이 있을 때 이를 진행하기 위해서 깃을 다시 돌리는 방법 밖에 없음
			- 차라리 이전 버전의 컨테이너가 존재했다면 조금 더 관리가 편했을 듯
		- 젠킨스 파이프라인
			- `docker exec`을 일일히 치는 것이 매우 불편함
			- 그래서 쉘 스크립트를 짰음
			- 그러나 스크립트로 앱을 구동할 시 앱이 실행된 이후로 파이프라인이 계속 실행 상태가 됨
				- 백그라운도 실행되게 하여 해결함
				- 그러나 이는 서버에 문제가 생겨도 젠킨스로 추적이 불가능하게 만듬
				- 문제 인식을 느리게 만들고 빠른 대처가 힘들었음
		- 컨테이너 세팅하는 스크립트, 앱 실행 스크립트가 따로 존재
			- 오직 초기를 위한 스크립트가 따로 존재하는 방식

저번 프로젝트에서의 배포 전략은 이러한 문제가 있었다.
도커파일을 활용하는 방법이 있다는 것은 알고 있었지만, 필요성을 느끼지 못했었고 이번 프로젝트에서는 버전 관리를 명확히 할 수 있는 도커 파일을 활용할 생각이다. 그리고 컨테이너 관리를 도와주는 도커 컴포즈까지 활용할 것이다. 


# vim surround

계속 vim의 대단함에 감탄하면서 왠지 남들 안 하는 것에 더 희열을 느끼는 나 자신에 모멸감이 들면서 그런 나 자신을 성찰하는 내 자신이 새삼 대단하다고 느껴지는 것으로 선민 의식 가지는 게 우스운...
아 그만하자 ㅋ
아무튼 vim이 가진 장점 중 하나가 뭐 씌우는 게 쉽다는 것인데, 사실 그걸 여태 활용은 안하고 있었다. 아직 vim을 잘 모르니까 차근차근 필요한 부분이 생길 때마다 공부하기로 마음 먹은 것이다. 
내가 각 잡고 공부를 한다면 시간이 너무 들어가니까, 어차피 매일 사용하는 부류의 툴이라면 이러한 방식도 괜찮겠다는 생각이 들었다. 
그래서 오늘 vim에 대해서 알아보며 시도하는 것은?
- 옵시디언 vim 조금 더 편리하게 활용하기
	- 노말 모드로 갈 때 자동으로 영어 되게 하기
	- vim surround 사용

라고 생각을 하고 봤다.
- https://github.com/hideakitai/obsidian-vim-im-control?tab=readme-ov-file
- https://github.com/ALONELUR/vim-im-select-obsidian
- https://github.com/esm7/obsidian-vimrc-support

이렇게 세 개의 플러그인을 설치하고 적용을 시켜보려 노력했으나 실패했다.
Input Method를 조정하는 방법이 있는 모양이라 그것을 가능하게 하려고 한 건데, 보기 좋게 실패. 
vimrc support에서는 제한적으로 적용은 가능하게 해준다. 대신 한 글자 명령만 가능하다;
다른 녀석들은 어떻게 된 것인지 제대로 작동이 안 된다.
![[Pasted image 20240303233132.png]]
이렇게 `im-select.exe`를 설치하고 이걸 실행할 수 있도록 설정을 해주었다.
![[Pasted image 20240303233227.png]]
요렇게! 이건 im controll에서 해준 설정
![[Pasted image 20240303233251.png]]
이건 im select에서 해준 설정이다.
혹시 양쪾이 충돌나는 이슈가 있는 것은 아닐까 한쪽을 할 때는 다른 쪽은 비활성화하고 작업을 진행했다.
그런데 결국 적용이 안 됐다. 

![[Pasted image 20240303234259.png]]
음. 혹시나 하는 마음에 봤는데 이것 문제인 것 같기도 하다.

개념이 조금 익숙해져서 보니까, im-select가 하는 일은 현재 입력 중인 im이 무엇인지 밝혀주고, 추가 인자를 전달할 때 해당하는 im으로 바꿔주는 일을 한다. 
그런데 내 im select가 제대로 작동하지 않는 이슈를 발견했다.
![[Pasted image 20240303234739.png]]
이제는 im select가 제대로 작동되는 것은 확인된다.

그럼에도 잘 작동하지 않는다. 휴. 일단 포기.
# 회고 및 다짐
뭐가 문제인지 잘 모르겠다. 일단 최소한 im select가 잘 작동하는 것을 확인했으니 내가 obsidian 설정을 잘못했거나, 얘네가 잘못 만든 것이다. 근데 여기에서 말해주는 대로 세팅을 다 했는데 내가 설정을 잘못한 건 아닐 것 같은데 이 정도면.
뭐든 초기 세팅하는 게 참 어려운 일인 것 같다. 