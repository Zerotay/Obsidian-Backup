# 사전 지식
- 클러스터
	- 서비스 묶음 단위
	- 여러 물리적 서버에 나뉜 여러 개의 컨테이너를 하나의 시스템으로 묶어서 관리하는 단위
	- Cluster Network Interface(CNI)
		- 쿠버네티스를 사용하기 위해 기본적으로 설치되어야 하는 플러그인
		- 컨테이너 간 네트워킹을 제어하는 인터페이스
		- 이것을 직접 사용하는 것은 어려운 일
			- Managed Service - 확장성과 고가용성을 고려하여 제공하는 서비스
			- Fully Managed Service(=Serverless) - 인프라 설정도 할 필요 없이 제공하는 서비스
- 클라우드 서비스
	- 사용하는데 있어 필요한 만큼의 자원을 유동적으로 관리하는 것이 비용 효율적
	- 쿠버네티스를 통해 이를 효과적으로 수행할 수 있음
	- 쿠버네티스를 쓰는 것은 IaaS, PaaS에 해당함
- Micro Service Architecture(MSA)
	- 서버의 기능을 잘개 쪼개어 한 기능이 다운되어도 실행 가능하도록 분산된 환경을 구축한 서버 구조
	- 왜 컨테이너 단위로 구현되는가
		- 다른 방법으로 VM이 있음
			- VM은 자원 공유와 격리를 핵심으로 함
			- 각종 프로그램을 독립적으로 구동할 수 있음
			- OS 단위이기에 무거움
		- 컨테이너 런타임
			- 리눅스의 cgroups, namespace라는 기술을 통해 구현된 환경
				- 이전에는 도커 자체가 기반이었으나 현재는 containerd가 표준
		- 자원 관리를 효율적으로 독립된 프로그램 실행이 가능함
- 컨테이너 런타임
	- 하나의 노드에서 동작
		- 노드는 하나의 개념 서버 단위
	- 오케스트레이션 툴 
		- 이러한 노드들을 생성, 배치, 관리를 하는 툴
		- 대표적인 것이 쿠버네티스

# 쿠버네티스 구조
- 쿠버네티스 특징
	- 오픈소스
	- 자동화
	- 컨테이너 관리
	- 선언적 구성
		- 사용자가 원하는 상태를 미리 선언하여 정의
		- 쿠버네티스는 이를 확인하고 이 사양에 맞추어 컨테이너를 관리
		- GitOps
			- 사용자가 깃에 자신이 원하는 상태를 올려두고 쿠버네티스가 그 상태에 맞춰 클러스터를 유지하는 방식의 운영
	- 명령형 구성
		- 위와 대비됨
		- 실행 중에 명령을 내리는 방식으로 쿠버네티스를 제어
- 아키텍쳐![[Pasted image 20240311233105.png]]
	- 두 가지 영역으로 구분
		- Control Plane(제어 영역)
			- 다른 노드들을 관리하는 마스터 노드
		- Data Plane(데이터 영역)
			- 워커 노드들의 집합
	- 사용자는 kubectl을 통해 제어 영역에 요청을 보내고 여기에서 쿠버네티스는 자신의 클러스터를 관리하게 됨
	- 제어 영역
		- kube-APIserver
			- kubectl 요청을 받는 서버
			- 클러스터에 대한 모든 명령을 수락하는 진입점
		- kube-scheduler
			- 노드의 자원 상태 파악
			- 사용할 공간을 예약, 할당
			- 사용자의 요청에 의해 사용될 곳은 실질적으로 이 놈이 결정함
		- etcd
			- 클러스터의 상태를 안정적으로 기록, 저장
			- 모든 객체의 상태가 저장됨
		- kube-controller-manager
			- 사용자의 요청과 클러스터의 상태를 파악
			- 상태를 지속적으로 모니터링하면서 바람직한 상태를 달성하기 위해 변경 시도
		- kube-cloud-manager
			- 클라우드 제공업체와 상호작용하는 컨트롤러 관리
	- 데이터 영역
		- 일을 하는 워커 노드들의 집합
		- 각 노드 컨테이너를 띄울 수 있는 능력이 있음
			- 각각 컨테이너 런타임을 가짐
		- kubelet
			- containerd를 가진 쿠버네티스의 컨테이너 런타임
		- kube-proxy
			- 클러스터 내부의 노드 간 네트워크 연결을 위한 프로세스

- 객체![[Pasted image 20240311233033.png]]
	- 클러스터 상태를 나타내는 영구 항목
	- 상태 관점의 분류
		- 객체 사양
			- 사용자가 정의한 바람직한 상태
		- 객체 상태
			- 현재 쿠버네티스가 가지고 있는 상태
	- 사양을 보고 상태를 알아서 맞춰주는 것이 쿠버네티스의 핵심 기능 중 하나
	- 사용 관점의 분류
		- Pod(파드)![[Pasted image 20240311234358.png]]
			- 배포 가능한 가장 작은 쿠버네티스 객체 단위
			- 내부에 여러 개의 컨테이너를 포함할 수 있음
			- 파드 단위의 스토리지와 네트워킹이 존재
			- 한 노드 위에 여러 개의 파드를 올릴 수 있음
			- 고유한 이름을 가짐
		- deployment
			- 같은 파드를 여러 개 사용할 수 있도록 하는 컨트롤러 객체
			- replicas를 활용해 같은 파드가 몇 개 있을지 정의 가능